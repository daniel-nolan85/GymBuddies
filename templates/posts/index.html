{% extends 'base.html' %}
{% load static %}
{% load custom_tags %}

{% block title %}Home{% endblock %}

{% block content %}

	<div class="main-section">
		<div class="container">
			<div class="m-4 text-center"><q id="randomQuote"></q></div>
			<div class="main-section-data">
				<div class="row">
					<div class="col-lg-8">
						<div class="main-ws-sec">
							<div class="post-topbar">
								{% if post_added %}
									<script>
										$(document).ready(function() {
											const Toast = Swal.mixin({
												toast: true,
												position: 'top',
												showConfirmButton: true,
												timer: 3000,
												timerProgressBar: true,
												didOpen: (toast) => {
													toast.addEventListener('mouseenter', Swal.stopTimer)
													toast.addEventListener('mouseleave', Swal.resumeTimer)
												}
											})
											Toast.fire({
												icon: 'success',
												title: 'New post added'
											})
										});
									</script>
								{% endif %}

								<div class="user-picy">
									<i class="fas fa-pen-alt mb-3" style="font-size: 24px;"></i>
								</div>
								<h3 style="font-weight: bold; font-size: 20px;">New Post</h3>

								<div class="comment_box">
									<div id="img-alert-box" class="mt-3"></div>
									<div id="vid-alert-box"></div>
									<div id="img-box"></div>
									<div id="vid-box"></div>
									<form action="" method="post" enctype="multipart/form-data" id="post-form">
										<div class="mb-4">
											{% csrf_token %}
											{{ p_form.content }}
										</div>
										<span class="post-links">
											<label><i class="fas fa-camera" style="cursor: pointer;"></i>
												{{ p_form.image }}
											</label>
											<label><i class="fas fa-video" style="cursor: pointer;"></i>
												{{ p_form.video }}
											</label>
											{{ p_form.category }}
											<button type="submit" class="active" name="submit_p_form">Post</button>
										</span>
									</form>
									<br>
									<div id="progress-box" class="d-none">Progress</div>
									<br>
									<div id="cancel-box" class="d-none">
										<button id="cancel-btn" class="btn btn-danger">Cancel</button>
									</div>
								</div>
							</div><!--post-topbar end-->

							<div class="posts-section infinite-container">
								{% for post in posts %}
									{% if post.author.user.is_active %}
										<div class="post-bar infinite-item" data-id="{{ post.id }}">
											<div class="post_topbar">
												<div class="usy-dt mb-2">
													{% if post.author.user == request.user %}
														<a href="{% url 'users:my_profile' %}"><img src="{{ post.author.get_avatar }}" alt="" style="height: 30px;"></a>
													{% else %}
														<a href="{% url 'users:profile_detail' slug=post.author.slug sender_id=request.user.id %}"><img src="{{ post.author.get_avatar }}" alt="" style="height: 30px;"></a>
													{% endif %}
													<div class="usy-name">
														{% if post.author.user == request.user %}
															<h3><a href="{% url 'users:my_profile' %}">{{ post.author.user }}</a></h3>
														{% else %}
															<h3><a href="{% url 'users:profile_detail' slug=post.author.slug sender_id=request.user.id %}">{{ post.author.user }}</a></h3>
														{% endif %}
														<span><img src="{% static 'images/clock.png' %}" alt="">{{ post.created|timesince }}</span>
													</div>
												</div>

												<div class="ed-opts">
													<ul class="bk-links">
														{% if post.author.user == request.user %}
															<li><a href="{% url 'posts:update' post.id %}"><i class="fas fa-edit"></i></a></li>
															<li><a href="" data-toggle="modal" data-target="#delete{{post.id}}"><i class="fas fa-trash"></i></a></li>
															<!-- modal -->
															<div class="modal fade" id="delete{{post.id}}" role="dialog">
																<div class="modal-dialog">
																	<div class="modal-content">
																		<!-- modal header -->
																		<div class="modal-header">
																			<h3 class="modal-title">Do you really want to delete?</h3>
																		</div>
																		<!-- modal body -->
																		<div class="modal-body">
																			<p>{{ post.content }}</p>
																		</div>
																		<!-- modal footer -->
																		<div class="modal-footer">
																			<button id="postDelete" type="submit" class="active" data-id="{{ post.id }}">Yes, Delete</button>
																			<button type="button" data-dismiss="modal">Cancel</button>
																		</div>
																	</div>
																</div>
															</div>
															<!-- end of modal -->
														{% endif %}
													</ul>
												</div>
											</div>

											<div class="job_descp">
												{% if post.image %}
													<div class="post-image-box">
														<img src="{{ post.image.url }}" alt="">
													</div>
													<br>
												{% endif %}
												{% if post.video %}
													<div class="post-video-box">
														<video width="200" controls>
															<source src='{{ MEDIA_URL }}{{ post.video }}' type='video/mp4'>
															Your browser does not support the video tag.
														</video>
													</div>
												{% endif %}
												{% if post.content|length > 150 %}
													<p id="half-{{ post.id }}" class="mt-3">{{ post.content|truncatechars:150 }}<a data-id="{{ post.id }}" href="javascript:void();" class="show-hide-txt"> view more</a></p>
													<p id="full-{{ post.id }}" class="mt-3" style="display: none;">{{ post.content }}</p>
												{% else %}
													<p>{{ post.content }}</p>
												{% endif %}

												<ul class="skill-tags">
													<li><a href="{% url 'posts:category_detail' pk=post.category.id slug=post.category.slug %}">{{ post.category.title }}</a></li>
												</ul>
											</div>

											<div class="job-status-bar">
												<div class="like-com">
													<p class="comment-count{{ post.id }}" style="color: #000;"><i class="fas fa-comment-alt mr-3"></i>{{ post.comments_num }}</p>
													<form action="{% url 'posts:high_fived' %}" method="post" class="high_five-form" id="{{ post.id }}">
														{% csrf_token %}
														<input type="hidden" name="post_id" value="{{ post.id }}">

														<button type="submit" class="high_five-btn{{ post.id }}" style="background: none; padding: 0px; border: none; display: inline; font-size: 14px;"><i class="fas fa-hand-sparkles"></i>
															{% if profile not in post.high_fived.all %}
																High Five
															{% else %}
																Take Back
															{% endif %}
														</button>
														<p class="high_five-count{{ post.id }} ml-3" style="display: inline; color: #000;">{{ post.high_fives_num }}</p>
													</form>
												</div>
											</div>

											<button type="button" class="com com-btn" style="background: none; padding: 0px; border: none;"><i class="fas fa-chevron-down"></i></button>

											<div class="com-list" id="comList" style="display: none;">
												{% if post.comment_set.all %}
													{% for comment in post.comment_set.all %}
														{% if comment.user.user.is_active %}
															<div class="comCard" data-id="{{ comment.id }}">
																<div class="commenter">
																	<div>
																		{% if comment.user.user == request.user %}
																			<a href="{% url 'users:my_profile' %}" class="view-more-pro">
																				<img class="com-pic mr-3" src="{{ comment.user.get_avatar }}">
																				<span id="com-name">{{ comment.user.user }}</span>
																			</a>
																		{% else %}
																			<a href="{% url 'users:profile_detail' slug=comment.user.slug sender_id=request.user.id %}" class="view-more-pro">
																				<img src="{{ comment.user.get_avatar }}" class="mr-3">
																				<span>{{ comment.user.user }}</span>
																			</a>
																		{% endif %}

																		<p class="ml-1">{{ comment.created|timesince }}</p>
																	</div>
																	<div>
																		{% if comment.user.user == request.user or post.author.user == request.user %}
																			<div class="ed-opts" style="position: absolute; right: 30px;">
																				<ul class="bk-links">
																					<li><a href="" data-toggle="modal" data-target="#delete-com{{comment.id}}"><i class="fas fa-trash"></i></a></li>
																					<!-- modal -->
																					<div class="modal fade" id="delete-com{{comment.id}}" role="dialog">
																						<div class="modal-dialog">
																							<div class="modal-content">
																								<!-- modal header -->
																								<div class="modal-header">
																									<h3 class="modal-title" style="color: #fff; font-weight: bold;">Do you really want to delete?</h3>
																								</div>
																								<!-- modal body -->
																								<div class="modal-body" style="padding: 20px;"><p>{{ comment.body }}</p></div>
																								<!-- modal footer -->
																								<div class="modal-footer">
																									<button id="comDelete" type="submit" class="active" data-id="{{ comment.id }}">Yes, Delete</button>
																									<button type="button" data-dismiss="modal">Cancel</button>
																								</div>
																							</div>
																						</div>
																					</div>
																					<!-- end of modal -->
																				</ul>
																			</div>
																		{% endif %}
																	</div>
																</div>
																<div class="job_descp">
																	{% if comment.body|length > 150 %}
																		<p id="half-{{ comment.id }}" class="mb-3 ml-5">{{ comment.body|truncatechars:150 }}<a data-id="{{ comment.id }}" href="javascript:void();" class="show-hide-com"> view more</a></p>
																		<p id="full-{{ comment.id }}" class="mb-3 ml-5" style="display: none;">{{ comment.body }}</p>
																	{% else %}
																		<p class="mb-3 ml-5">{{ comment.body }}</p>
																	{% endif %}
																</div>
															</div>

														{% endif %}
													{% endfor %}
												{% endif %}
											</div>
											<div class="post-comment">
												<div class="comment_box mt-2">
													<form action="{% url 'posts:comment' %}" method="post" class="comment_form" id="addComForm">
														{% csrf_token %}
														<input type="hidden" name="post_id" value={{ post.id }}>
														<input type="hidden" name="comment_id" value={{ comment.id }}>
														{% comment_tag %}
														<button id="addComBtn" type="button" data-id="{{ comment.id }}">Send</button>
													</form>
												</div>
											</div><!--post-comment end-->
										</div><!--post-bar end-->
									{% endif %}
								{% endfor %}
							</div><!--posts-section end-->

							{% if posts.has_next %}
								<a href="?page={{ posts.next_page_number }}" class="infinite-more-link"></a>
								<div class="process-comm">
									<div class="spinner">
										<div class="bounce1"></div>
										<div class="bounce2"></div>
										<div class="bounce3"></div>
									</div>
								</div><!--process-comm end-->
							{% endif %}

						</div><!--main-ws-sec end-->
					</div>
					{% include 'right_side.html' %}

				</div>
			</div><!-- main-section-data end-->
		</div>
	</div>


	<script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
	<script src="{% static 'js/infinite.min.js' %}"></script>

	<!--	quotes-->
	<script>
		function ShowQuote() {
			var Quote = [
				'You are worth it. Keep going.',
				'Sore today. Strong tomorrow.',
				'Life begins at the end of your comfort zone.',
				'The only bad workout is the one that didn\'t happen.',
				'Excuses are for those who don\'t want it badly enough.',
				'Success comes after you stop making excuses.',
				'Motivation gets you started. Habit keeps you going.',
				'Do something today that your future self will thank you for.',
				'You don\'t find will power, you create it.',
				'Believe you can and you\'re halfway there.',
				'Unless you puke, faint, or die, keep going.',
				'Don\'t stop when you\'re tired. Stop when you\'re done.',
				'The harder the struggle, the more glorious the triumph.',
				'We must all suffer one of two things: the pain of discipline, or the pain of regret.',
				'Results happen over time, not overnight.',
				'Every workout counts.',
				'It\'s a process. Change takes time.',
				'Do it for the after selfie.',
				'When life knocks you down, do a burpee.',
				'You don\'t get the ass you want just by sitting on it.',
				'If you still look cute after the gym, you didn\'t go hard enough.',
				'You are becoming the person you want to be.',
				'Whether you think you can or you think you can\'t, you\'re right.',
				'The successful warrior is the average man, with laser-like focus.',
				'You must expect great things of yourself before you can do them.',
				'Action is the foundational key to all success.',
				'A champion is someone who gets up when they feel they can\'t.',
				'What hurts today makes you stronger tomorrow.',
				'If something stands between you and your success, move it.',
				'If you want something you\'ve never had, you must be willing to do something you\'ve never done.',
				'Good things come to those who sweat.',
				'It\'s not about being better than someone else. It\'s about being better than you used to be.',
				'No matter how slow you go, you are still lapping everybody on the couch.',
				'You miss 100% of the shots you don\'t take.',
				'You are only one workout away from a good mood.',
				'The difference between try and triumph is a little "umph".',
				'Don\'t count the days, make the days count.',
				'Do what you have to do, until you can do what you want to do.',
				'Strive for progress, not perfection.',
				'Biceps don\'t grow on trees.',
				'Hustle for that muscle.',
				'I like big weights and I cannot lie.',
				'To be number one, you have to train like you\'re number two.',
				'The pain of discipline is nothing like the pain of disappointment.',
			];
			var Pick = Math.floor(Math.random() * (Quote.length));
			document.getElementById('randomQuote').innerHTML = '"' + (Quote[Pick]) + '"';
			console.log('hello')
		  }

		  document.addEventListener("load", ShowQuote());

  	</script>

	<!--	add posts-->
	<script>
		const postForm = document.getElementById('post-form')
		const imgInput = document.getElementById('id_image')
		const vidInput = document.getElementById('id_video')
		const imgAlertBox = document.getElementById('img-alert-box')
		const vidAlertBox = document.getElementById('vid-alert-box')
		const imgBox = document.getElementById('img-box')
		const vidBox = document.getElementById('vid-box')
		const progressBox = document.getElementById('progress-box')
		const cancelBox = document.getElementById('cancel-box')
		const cancelBtn = document.getElementById('cancel-btn')
		const csrf = document.getElementsByName('csrfmiddlewaretoken')

		// add an image
		imgInput.addEventListener('change', () => {
			progressBox.classList.remove('d-none')
			cancelBox.classList.remove('d-none')

			const img_data = imgInput.files[0]
			const url = URL.createObjectURL(img_data)
			console.log(img_data)

			const fd = new FormData()
			fd.append('csrfmiddlewaretoken', csrf[0].value)
			fd.append('image', img_data)

			$.ajax({
				type: 'POST',
				url: postForm.action,
				enctype: 'multipart/form-data',
				data: fd,
				beforeSend: function() {
					console.log('before')
					imgAlertBox.innerHTML = ''
					imgBox.innerHTML = ''
				},
				xhr: function() {
					const xhr = new window.XMLHttpRequest();
					xhr.upload.addEventListener('progress', e => {
						if (e.lengthComputable) {
							const percent = e.loaded / e.total * 100
							console.log(percent)
							progressBox.innerHTML = `<div class="progress">
														<div class="progress-bar" role="progressbar" style="width: ${percent}%" aria-valuenow="${percent}" aria-valuemin="0" aria-valuemax="100"></div>
													 </div>
													 <p>${percent.toFixed(1)}%</p>`
						}
					})
					cancelBtn.addEventListener('click', () => {
						xhr.abort()
						setTimeout(() => {
							postForm.reset()
							progressBox.innerHTML = ''
							imgAlertBox.innerHTML = ''
							cancelBox.classList.add('d-none')
						}, 2000)

					})
					return xhr
				},
				success: function(response) {
					console.log(response)
					imgBox.innerHTML = `<img src='${url}' height='200px' class='mr-3 mb-3'>`
					imgAlertBox.innerHTML = `<div class="alert alert-success" role="alert">
                                    			Your image is now ready to post
										 	 </div>`
					cancelBox.classList.add('d-none')
				},
				error: function(error) {
					console.log(error)
					imgAlertBox.innerHTML = `<div class="alert alert-danger" role="alert">
                                    			Oops... something went wrong
										  	 </div>`
				},
				cache: false,
				contentType: false,
				processData: false,
			})
		})

		// add a video
		vidInput.addEventListener('change', () => {
			progressBox.classList.remove('d-none')
			cancelBox.classList.remove('d-none')

			const vid_data = vidInput.files[0]
			const url = URL.createObjectURL(vid_data)
			console.log(vid_data)

			const fd = new FormData()
			fd.append('csrfmiddlewaretoken', csrf[0].value)
			fd.append('video', vid_data)

			$.ajax({
				type: 'POST',
				url: postForm.action,
				enctype: 'multipart/form-data',
				data: fd,
				beforeSend: function() {
					console.log('before')
					vidAlertBox.innerHTML = ''
					vidBox.innerHTML = ''
				},
				xhr: function() {
					const xhr = new window.XMLHttpRequest();
					xhr.upload.addEventListener('progress', e => {
						if (e.lengthComputable) {
							const percent = e.loaded / e.total * 100
							console.log(percent)
							progressBox.innerHTML = `<div class="progress">
														<div class="progress-bar" role="progressbar" style="width: ${percent}%" aria-valuenow="${percent}" aria-valuemin="0" aria-valuemax="100"></div>
													 </div>
													 <p>${percent.toFixed(1)}%</p>`
						}
					})
					cancelBtn.addEventListener('click', () => {
						xhr.abort()
						setTimeout(() => {
							postForm.reset()
							progressBox.innerHTML = ''
							vidAlertBox.innerHTML = ''
							cancelBox.classList.add('d-none')
						}, 2000)

					})
					return xhr
				},
				success: function(response) {
					console.log(response)
					vidBox.innerHTML = `<video height='200px' class='mb-3'><source src='${url}' type='video/mp4'></video>`
					vidAlertBox.innerHTML = `<div class="alert alert-success" role="alert">
                                    			Your video is now ready to post
                                  		  	 </div>`
					cancelBox.classList.add('d-none')
				},
				error: function(error) {
					console.log(error)
					vidAlertBox.innerHTML = `<div class="alert alert-danger" role="alert">
                                    			Oops... something went wrong
										  	 </div>`
				},
				cache: false,
				contentType: false,
				processData: false,
			})
		})
	</script>

	<!--	delete posts-->
	<script>
        $(document).on('click', function(){
			var csrfToken = $('input[name=csrfmiddlewaretoken]').val();
			$('.post-bar').on('click', '#postDelete', function() {
                var dataId = $(this).data('id');
                console.log(dataId)
				$.ajax({
                    url: '/delete-post/' + dataId,
                    data: {
                        csrfmiddlewaretoken: csrfToken,
                        id: dataId
                    },
                    type: 'post',
                    dataType: 'json',
                    success: function() {
                    	console.log('success')
                    	$('.post-bar[data-id="' + dataId + '"]').remove()
                        $('#delete{{post.id}}').modal('hide');$('body').removeClass('modal-open');$('.modal-backdrop').remove();
                    	const Toast = Swal.mixin({
                                toast: true,
                                position: 'top',
                                showConfirmButton: true,
                                timer: 3000,
                                timerProgressBar: true,
                                didOpen: (toast) => {
                                toast.addEventListener('mouseenter', Swal.stopTimer)
                                toast.addEventListener('mouseleave', Swal.resumeTimer)
                            }
                        })
                        Toast.fire({
                            icon: 'error',
                            title: 'Post deleted'
                        })
                    },
                    error: function(error) {
                        console.log('error')
                    }
                })
            });
        });
    </script>

	<!--	add comments-->
	<script>
		$(document).on('click', function(){
			$('.post-comment').on('click', '#addComBtn', function() {
                var serializedData = $(this).closest("form").serialize();

                var dataId = $(this).data('id');
				var comment_id = $(this).closest("form").find("input[name=comment_id]").val()
				console.log(comment_id)
				console.log($(this).closest(".post-comment").prev(".com-list").find(".comCard:last").data('id'))
				var comments_div = $(this).closest(".post-comment").prev(".com-list");
				var form = $(this).closest("form");

				const post_id = $('.post-bar').data('id')
				let res;
                const commentsNum = $(`.comment-count${post_id}`).text()
                const trimCount = parseInt(commentsNum)

				var avatar = $('.com-pic').attr('src');
				var name = $('#com-name').text();

                $.ajax({
                    url: /comment/,
                    data: serializedData,
                    type: 'POST',
                    success: function(response) {
  						console.log(response.comment)
						$(comments_div).append('<div class="comCard" data-id="' + response.comment.id + '"><div class="commenter"><div><a href="{% url 'users:my_profile' %}" class="view-more-pro"><img src="' + avatar + '" style="height: 30px;" class="mr-3"><span>' + name + '</span></a><p class="ml-1" style="display: inline-block; color: #b2b2b2;">' + "just now" + '</p></div><div><div class="ed-opts"><ul class="bk-links" style="position: relative; left: 5px;"><li><a href="" data-toggle="modal" data-target="#delete-com' + response.comment.id + '"><i class="fas fa-trash"></i></a></li><div class="modal fade" id="delete-com' + response.comment.id + '" role="dialog"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h3 class="modal-title" style="color: #fff; font-weight: bold;">Do you really want to delete?</h3></div><div class="modal-body" style="padding: 20px;"><p>' + response.comment.body + '</p></div><div class="modal-footer"><button id="comDelete" type="submit" class="active" data-id="' + response.comment.id + '">Yes, Delete</button><button type="button" data-dismiss="modal">Cancel</button></div></div></div></div></ul></div></div></div><p class="mb-3 ml-5">' + response.comment.body + '</p></div>')
						res = trimCount + 1
						$(`.comment-count${post_id}`).text(res).prepend('<i class="fas fa-comment-alt mr-3"></i>')

                    	const Toast = Swal.mixin({
							toast: true,
							position: 'top',
							showConfirmButton: true,
							timer: 3000,
							timerProgressBar: true,
							didOpen: (toast) => {
                                toast.addEventListener('mouseenter', Swal.stopTimer)
                                toast.addEventListener('mouseleave', Swal.resumeTimer)
                            }
                        })
                            Toast.fire({
                                icon: 'success',
                                title: 'Comment added'
                            })
                    },
                    error: function(error) {
                        console.log('error')
                    }
                })
                form.trigger("reset");
            });
		});
	</script>

	<!--	delete comments-->
	<script>
        $(document).on('click', function(){
			var csrfToken = $('input[name=csrfmiddlewaretoken]').val();
            $('.com-list').on('click', '#comDelete', function() {

                var dataId = $(this).data('id');
                console.log(dataId)

                const post_id = $('.post-bar').data('id')
				let res;
                const commentsNum = $(`.comment-count${post_id}`).text()
                const trimCount = parseInt(commentsNum)

                $.ajax({
                    url: '/delete-comment/' + dataId,
                    data: {
                        csrfmiddlewaretoken: csrfToken,
                        id: dataId
                    },
                    type: 'post',
                    dataType: 'json',
                    success: function() {
                    	console.log('success')
                        $('.comCard[data-id="' + dataId + '"]').remove()
                        res = trimCount - 1
						$(`.comment-count${post_id}`).text(res).prepend('<i class="fas fa-comment-alt mr-3"></i>')
                        $('#delete-com{{comment.id}}').modal('hide');$('body').removeClass('modal-open');$('.modal-backdrop').remove();
                    	const Toast = Swal.mixin({
                                toast: true,
                                position: 'top',
                                showConfirmButton: true,
                                timer: 3000,
                                timerProgressBar: true,
                                didOpen: (toast) => {
                                toast.addEventListener('mouseenter', Swal.stopTimer)
                                toast.addEventListener('mouseleave', Swal.resumeTimer)
                            }
                        })
                        Toast.fire({
                            icon: 'error',
                            title: 'Comment deleted'
                        })
                    },
                    error: function(error) {
                        console.log('error')
                    }
                })
            });
        });
    </script>

<!--	infinite scroll-->
	<script>
		var infinite = new Waypoint.Infinite({
			element: $('.infinite-container')[0],
			offset: 'bottom-in-view',
			onBeforePageLoad: function () {
				$('.spinner').show();
			},
			onAfterPageLoad: function () {
				$('.spinner').hide();
			}
		});
	</script>

<!--	view more posts -->
   <script type="text/javascript">
	$(".show-hide-txt").click(function(){
		var id = $(this).data("id");
		$("#half-"+id).hide();
		$("#full-"+id).show();
	});
   </script>

<!-- view more comments -->
   <script type="text/javascript">
	$(".show-hide-com").click(function(){
		var comId = $(this).data("id");
		$("#half-"+comId).hide();
		$("#full-"+comId).show();
	});
   </script>

<!-- high five and take back -->
  <script type="text/javascript">
	$('.high_five-form').submit(function(e){
		e.preventDefault()

		const post_id = $(this).attr('id')
		const high_fiveText = $(`.high_five-btn${post_id}`).text()
		const trim = $.trim(high_fiveText)
		const url = $(this).attr('action')

		let res;
		const high_fives = $(`.high_five-count${post_id}`).text()
		const trimCount = parseInt(high_fives)

		$.ajax({
			type: 'POST',
			url: url,
			data: {
				'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val(),
				'post_id': post_id,
			},
			success: function(response) {
			if(trim === 'Take Back') {
				$(`.high_five-btn${post_id}`).text('High Five').prepend('<i class="fas fa-hand-sparkles"></i>')
				res = trimCount - 1
			} else {
				$(`.high_five-btn${post_id}`).text('Take Back').prepend('<i class="fas fa-hand-sparkles"></i>')
				res = trimCount + 1
			}
				$(`.high_five-count${post_id}`).text(res)
			},
				error: function(response) {
				console.log('error', response)
			}
		})
	})
	</script>

<!-- show/hide comments-->
	<script>
		$(document).on('click', '.com-btn', function(){
			$("i", this).toggleClass("fas fa-chevron-down fas fa-chevron-up");

			if($("i", this).hasClass('fa-chevron-up')) {
				$(this).next(".com-list").show("slow");
			} else {
				$(this).next(".com-list").hide("slow");
			}
		});
	</script>

{% endblock %}